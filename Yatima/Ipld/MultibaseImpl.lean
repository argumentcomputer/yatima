constant base2Table: String := 
  "01"
constant base8Table: String := 
  "01234567"
constant base10Table: String := 
  "0123456789"
constant base16Table: String := 
  "0123456789abcdef"
constant base16upperTable: String := 
  "0123456789ABCDEF"
constant base32Table: String := 
  "abcdefghijklmnopqrstuvwxyz234567"
constant base32upperTable: String := 
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"
constant base32hexTable: String := 
  "0123456789abcdefghijklmnopqrstuv"
constant base32hexupperTable: String := 
  "0123456789ABCDEFGHIJKLMNOPQRSTUV"
constant base32zTable: String := 
  "ybndrfg8ejkmcpqxot1uwisza345h769"
constant base36Table: String := 
  "0123456789abcdefghijklmnopqrstuvwxyz"
constant base36upperTable: String := 
  "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
constant base58flickrTable: String := 
  "123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"
constant base58btcTable: String :=  
  "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"
constant base64Table: String :=  
  "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
constant base64urlTable: String :=  
  "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"

-- These functions should be generated from Lean macros

def digitBase2 : Nat → Char
| 0 => '0'
| 1 => '1'
| _ => '0'

def readBase2 : Char → Option Nat
| '0' => some 0
| '1' => some 1
| _   => none

def digitBase8 : Nat → Char
| 0 => '0'
| 1 => '1'
| 2 => '2'
| 3 => '3'
| 4 => '4'
| 5 => '5'
| 6 => '6'
| 7 => '7'
| _ => '0'

def readBase8 : Char → Option Nat
| '0' => some 0
| '1' => some 1
| '2' => some 2
| '3' => some 3
| '4' => some 4
| '5' => some 5
| '6' => some 6
| '7' => some 7
| _ => none

def digitBase10 : Nat → Char
| 0 => '0'
| 1 => '1'
| 2 => '2'
| 3 => '3'
| 4 => '4'
| 5 => '5'
| 6 => '6'
| 7 => '7'
| 8 => '8'
| 9 => '9'
| _ => '0'

def readBase10 : Char → Option Nat
| '0' => some 0
| '1' => some 1
| '2' => some 2
| '3' => some 3
| '4' => some 4
| '5' => some 5
| '6' => some 6
| '7' => some 7
| '8' => some 8
| '9' => some 9
| _ => none

def digitBase16 : Nat → Char
| 0 => '0'
| 1 => '1'
| 2 => '2'
| 3 => '3'
| 4 => '4'
| 5 => '5'
| 6 => '6'
| 7 => '7'
| 8 => '8'
| 9 => '9'
| 10 => 'a'
| 11 => 'b'
| 12 => 'c'
| 13 => 'd'
| 14 => 'e'
| 15 => 'f'
| _ => '0'

def digitBase16Upper : Nat → Char
| 0 => '0'
| 1 => '1'
| 2 => '2'
| 3 => '3'
| 4 => '4'
| 5 => '5'
| 6 => '6'
| 7 => '7'
| 8 => '8'
| 9 => '9'
| 10 => 'A'
| 11 => 'B'
| 12 => 'C'
| 13 => 'D'
| 14 => 'E'
| 15 => 'F'
| _ => '0'

def readBase16 : Char → Option Nat
| '0' => some 0
| '1' => some 1
| '2' => some 2
| '3' => some 3
| '4' => some 4
| '5' => some 5
| '6' => some 6
| '7' => some 7
| '8' => some 8
| '9' => some 9
| 'a' => some 10
| 'b' => some 11
| 'c' => some 12
| 'd' => some 13
| 'e' => some 14
| 'f' => some 15
| 'A' => some 10
| 'B' => some 11
| 'C' => some 12
| 'D' => some 13
| 'E' => some 14
| 'F' => some 15
| _ => none

def digitBase32Hex : Nat → Char
| 0  => '0'
| 1  => '1'
| 2  => '2'
| 3  => '3'
| 4  => '4'
| 5  => '5'
| 6  => '6'
| 7  => '7'
| 8  => '8'
| 9  => '9'
| 10 => 'a'
| 11 => 'b'
| 12 => 'c'
| 13 => 'd'
| 14 => 'e'
| 15 => 'f'
| 16 => 'g'
| 17 => 'h'
| 18 => 'i'
| 19 => 'j'
| 20 => 'k'
| 21 => 'l'
| 22 => 'm'
| 23 => 'n'
| 24 => 'o'
| 25 => 'p'
| 26 => 'q'
| 27 => 'r'
| 28 => 's'
| 29 => 't'
| 30 => 'u'
| 31 => 'v'
| _ => '0'

def digitBase32HexUpper : Nat → Char
| 0  => '0'
| 1  => '1'
| 2  => '2'
| 3  => '3'
| 4  => '4'
| 5  => '5'
| 6  => '6'
| 7  => '7'
| 8  => '8'
| 9  => '9'
| 10 => 'A'
| 11 => 'B'
| 12 => 'C'
| 13 => 'D'
| 14 => 'E'
| 15 => 'F'
| 16 => 'G'
| 17 => 'H'
| 18 => 'I'
| 19 => 'J'
| 20 => 'K'
| 21 => 'L'
| 22 => 'M'
| 23 => 'N'
| 24 => 'O'
| 25 => 'P'
| 26 => 'Q'
| 27 => 'R'
| 28 => 'S'
| 29 => 'T'
| 30 => 'U'
| 31 => 'V'
| _ => '0'

def readBase32Hex : Char → Option Nat
| '0' => some 0
| '1' => some 1
| '2' => some 2
| '3' => some 3
| '4' => some 4
| '5' => some 5
| '6' => some 6
| '7' => some 7
| '8' => some 8
| '9' => some 9
| 'a' => some 10
| 'b' => some 11
| 'c' => some 12
| 'd' => some 13
| 'e' => some 14
| 'f' => some 15
| 'g' => some 16
| 'h' => some 17
| 'i' => some 18
| 'j' => some 19
| 'k' => some 20
| 'l' => some 21
| 'm' => some 22
| 'n' => some 23
| 'o' => some 24
| 'p' => some 25
| 'q' => some 26
| 'r' => some 27
| 's' => some 28
| 't' => some 29
| 'u' => some 30
| 'v' => some 31
| 'A' => some 10
| 'B' => some 11
| 'C' => some 12
| 'D' => some 13
| 'E' => some 14
| 'F' => some 15
| 'G' => some 16
| 'H' => some 17
| 'I' => some 18
| 'J' => some 19
| 'K' => some 20
| 'L' => some 21
| 'M' => some 22
| 'N' => some 23
| 'O' => some 24
| 'P' => some 25
| 'Q' => some 26
| 'R' => some 27
| 'S' => some 28
| 'T' => some 29
| 'U' => some 30
| 'V' => some 31
| _ => none

def digitBase32 : Nat → Char
| 0  => 'a'
| 1  => 'b'
| 2  => 'c'
| 3  => 'd'
| 4  => 'e'
| 5  => 'f'
| 6  => 'g'
| 7  => 'h'
| 8  => 'i'
| 9  => 'j'
| 10 => 'k'
| 11 => 'l'
| 12 => 'm'
| 13 => 'n'
| 14 => 'o'
| 15 => 'p'
| 16 => 'q'
| 17 => 'r'
| 18 => 's'
| 19 => 't'
| 20 => 'u'
| 21 => 'v'
| 22 => 'w'
| 23 => 'x'
| 24 => 'y'
| 25 => 'z'
| 26 => '2'
| 27 => '3'
| 28 => '4'
| 29 => '5'
| 30 => '6'
| 31 => '7'
| _ => 'a'

def digitBase32Upper : Nat → Char
| 0  => 'A'
| 1  => 'B'
| 2  => 'C'
| 3  => 'D'
| 4  => 'E'
| 5  => 'F'
| 6  => 'G'
| 7  => 'H'
| 8  => 'I'
| 9  => 'J'
| 10 => 'K'
| 11 => 'L'
| 12 => 'M'
| 13 => 'N'
| 14 => 'O'
| 15 => 'P'
| 16 => 'Q'
| 17 => 'R'
| 18 => 'S'
| 19 => 'T'
| 20 => 'U'
| 21 => 'V'
| 22 => 'W'
| 23 => 'X'
| 24 => 'Y'
| 25 => 'Z'
| 26 => '2'
| 27 => '3'
| 28 => '4'
| 29 => '5'
| 30 => '6'
| 31 => '7'
| _ => 'A'


def readBase32 : Char → Option Nat
| 'a' => some 0
| 'b' => some 1
| 'c' => some 2
| 'd' => some 3
| 'e' => some 4
| 'f' => some 5
| 'g' => some 6
| 'h' => some 7
| 'i' => some 8
| 'j' => some 9
| 'k' => some 10
| 'l' => some 11
| 'm' => some 12
| 'n' => some 13
| 'o' => some 14
| 'p' => some 15
| 'q' => some 16
| 'r' => some 17
| 's' => some 18
| 't' => some 19
| 'u' => some 20
| 'v' => some 21
| 'w' => some 22
| 'x' => some 23
| 'y' => some 24
| 'z' => some 25
| 'A' => some 0
| 'B' => some 1
| 'C' => some 2
| 'D' => some 3
| 'E' => some 4
| 'F' => some 5
| 'G' => some 6
| 'H' => some 7
| 'I' => some 8
| 'J' => some 9
| 'K' => some 10
| 'L' => some 11
| 'M' => some 12
| 'N' => some 13
| 'O' => some 14
| 'P' => some 15
| 'Q' => some 16
| 'R' => some 17
| 'S' => some 18
| 'T' => some 19
| 'U' => some 20
| 'V' => some 21
| 'W' => some 22
| 'X' => some 23
| 'Y' => some 24
| 'Z' => some 25
| '2' => some 26
| '3' => some 27
| '4' => some 28
| '5' => some 29
| '6' => some 30
| '7' => some 31
| _ => none

def digitBase32Z : Nat → Char
| 0  => 'y'
| 1  => 'b'
| 2  => 'n'
| 3  => 'd'
| 4  => 'r'
| 5  => 'f'
| 6  => 'g'
| 7  => '8'
| 8  => 'e'
| 9  => 'j'
| 10 => 'k'
| 11 => 'm'
| 12 => 'c'
| 13 => 'p'
| 14 => 'q'
| 15 => 'x'
| 16 => 'o'
| 17 => 't'
| 18 => '1'
| 19 => 'u'
| 20 => 'w'
| 21 => 'i'
| 22 => 's'
| 23 => 'z'
| 24 => 'a'
| 25 => '3'
| 26 => '4'
| 27 => '5'
| 28 => 'h'
| 29 => '7'
| 30 => '6'
| 31 => '9'
| _ => 'y'

def readBase32Z : Char → Option Nat
| 'y' => some 0
| 'b' => some 1
| 'n' => some 2
| 'd' => some 3
| 'r' => some 4
| 'f' => some 5
| 'g' => some 6
| '8' => some 7
| 'e' => some 8
| 'j' => some 9
| 'k' => some 10
| 'm' => some 11
| 'c' => some 12
| 'p' => some 13
| 'q' => some 14
| 'x' => some 15
| 'o' => some 16
| 't' => some 17
| '1' => some 18
| 'u' => some 19
| 'w' => some 20
| 'i' => some 21
| 's' => some 22
| 'z' => some 23
| 'a' => some 24
| '3' => some 25
| '4' => some 26
| '5' => some 27
| 'h' => some 28
| '7' => some 29
| '6' => some 30
| '9' => some 31
| _  => none

def digitBase36 : Nat → Char
| 0  => '0'
| 1  => '1'
| 2  => '2'
| 3  => '3'
| 4  => '4'
| 5  => '5'
| 6  => '6'
| 7  => '7'
| 8  => '8'
| 9  => '9'
| 10 => 'a'
| 11 => 'b'
| 12 => 'c'
| 13 => 'd'
| 14 => 'e'
| 15 => 'f'
| 16 => 'g'
| 17 => 'h'
| 18 => 'i'
| 19 => 'j'
| 20 => 'k'
| 21 => 'l'
| 22 => 'm'
| 23 => 'n'
| 24 => 'o'
| 25 => 'p'
| 26 => 'q'
| 27 => 'r'
| 28 => 's'
| 29 => 't'
| 30 => 'u'
| 31 => 'v'
| 32 => 'w'
| 33 => 'x'
| 34 => 'y'
| 35 => 'z'
| _ => '0'

def digitBase36Upper : Nat → Char
| 0  => '0'
| 1  => '1'
| 2  => '2'
| 3  => '3'
| 4  => '4'
| 5  => '5'
| 6  => '6'
| 7  => '7'
| 8  => '8'
| 9  => '9'
| 10 => 'A'
| 11 => 'B'
| 12 => 'C'
| 13 => 'D'
| 14 => 'E'
| 15 => 'F'
| 16 => 'G'
| 17 => 'H'
| 18 => 'I'
| 19 => 'J'
| 20 => 'K'
| 21 => 'L'
| 22 => 'M'
| 23 => 'N'
| 24 => 'O'
| 25 => 'P'
| 26 => 'Q'
| 27 => 'R'
| 28 => 'S'
| 29 => 'T'
| 30 => 'U'
| 31 => 'V'
| 32 => 'W'
| 33 => 'X'
| 34 => 'Y'
| 35 => 'Z'
| _ => '0'

def readBase36 : Char → Option Nat
| '0' => some 0
| '1' => some 1
| '2' => some 2
| '3' => some 3
| '4' => some 4
| '5' => some 5
| '6' => some 6
| '7' => some 7
| '8' => some 8
| '9' => some 9
| 'a' => some 10
| 'b' => some 11
| 'c' => some 12
| 'd' => some 13
| 'e' => some 14
| 'f' => some 15
| 'g' => some 16
| 'h' => some 17
| 'i' => some 18
| 'j' => some 19
| 'k' => some 20
| 'l' => some 21
| 'm' => some 22
| 'n' => some 23
| 'o' => some 24
| 'p' => some 25
| 'q' => some 26
| 'r' => some 27
| 's' => some 28
| 't' => some 29
| 'u' => some 30
| 'v' => some 31
| 'w' => some 32
| 'x' => some 33
| 'y' => some 34
| 'z' => some 35
| 'A' => some 10
| 'B' => some 11
| 'C' => some 12
| 'D' => some 13
| 'E' => some 14
| 'F' => some 15
| 'G' => some 16
| 'H' => some 17
| 'I' => some 18
| 'J' => some 19
| 'K' => some 20
| 'L' => some 21
| 'M' => some 22
| 'N' => some 23
| 'O' => some 24
| 'P' => some 25
| 'Q' => some 26
| 'R' => some 27
| 'S' => some 28
| 'T' => some 29
| 'U' => some 30
| 'V' => some 31
| 'W' => some 32
| 'X' => some 33
| 'Y' => some 34
| 'Z' => some 35
| _ => none

def digitBase58Flickr : Nat → Char
| 0  => '1'
| 1  => '2'
| 2  => '3'
| 3  => '4'
| 4  => '5'
| 5  => '6'
| 6  => '7'
| 7  => '8'
| 8  => '9'
| 9  => 'a'
| 10 => 'b'
| 11 => 'c'
| 12 => 'd'
| 13 => 'e'
| 14 => 'f'
| 15 => 'g'
| 16 => 'h'
| 17 => 'i'
| 18 => 'j'
| 19 => 'k'
| 20 => 'm'
| 21 => 'n'
| 22 => 'o'
| 23 => 'p'
| 24 => 'q'
| 25 => 'r'
| 26 => 's'
| 27 => 't'
| 28 => 'u'
| 29 => 'v'
| 30 => 'w'
| 31 => 'x'
| 32 => 'y'
| 33 => 'z'
| 34 => 'A'
| 35 => 'B'
| 36 => 'C'
| 37 => 'D'
| 38 => 'E'
| 39 => 'F'
| 40 => 'G'
| 41 => 'H'
| 42 => 'J'
| 43 => 'K'
| 44 => 'L'
| 45 => 'M'
| 46 => 'N'
| 47 => 'P'
| 48 => 'Q'
| 49 => 'R'
| 50 => 'S'
| 51 => 'T'
| 52 => 'U'
| 53 => 'V'
| 54 => 'W'
| 55 => 'X'
| 56 => 'Y'
| 57 => 'Z'
| _ => '1'

def readBase58Flickr : Char → Option Nat
| '1' => some 0
| '2' => some 1
| '3' => some 2
| '4' => some 3
| '5' => some 4
| '6' => some 5
| '7' => some 6
| '8' => some 7
| '9' => some 8
| 'a' => some 9
| 'b' => some 10
| 'c' => some 11
| 'd' => some 12
| 'e' => some 13
| 'f' => some 14
| 'g' => some 15
| 'h' => some 16
| 'i' => some 17
| 'j' => some 18
| 'k' => some 19
| 'm' => some 20
| 'n' => some 21
| 'o' => some 22
| 'p' => some 23
| 'q' => some 24
| 'r' => some 25
| 's' => some 26
| 't' => some 27
| 'u' => some 28
| 'v' => some 29
| 'w' => some 30
| 'x' => some 31
| 'y' => some 32
| 'z' => some 33
| 'A' => some 34
| 'B' => some 35
| 'C' => some 36
| 'D' => some 37
| 'E' => some 38
| 'F' => some 39
| 'G' => some 40
| 'H' => some 41
| 'J' => some 42
| 'K' => some 43
| 'L' => some 44
| 'M' => some 45
| 'N' => some 46
| 'P' => some 47
| 'Q' => some 48
| 'R' => some 49
| 'S' => some 50
| 'T' => some 51
| 'U' => some 52
| 'V' => some 53
| 'W' => some 54
| 'X' => some 55
| 'Y' => some 56
| 'Z' => some 57
| _ => none

def digitBase58BTC : Nat → Char
| 0  => '1'
| 1  => '2'
| 2  => '3'
| 3  => '4'
| 4  => '5'
| 5  => '6'
| 6  => '7'
| 7  => '8'
| 8  => '9'
| 9  => 'A'
| 10 => 'B'
| 11 => 'C'
| 12 => 'D'
| 13 => 'E'
| 14 => 'F'
| 15 => 'G'
| 16 => 'H'
| 17 => 'J'
| 18 => 'K'
| 19 => 'L'
| 20 => 'M'
| 21 => 'N'
| 22 => 'P'
| 23 => 'Q'
| 24 => 'R'
| 25 => 'S'
| 26 => 'T'
| 27 => 'U'
| 28 => 'V'
| 29 => 'W'
| 30 => 'X'
| 31 => 'Y'
| 32 => 'Z'
| 33 => 'a'
| 34 => 'b'
| 35 => 'c'
| 36 => 'd'
| 37 => 'e'
| 38 => 'f'
| 39 => 'g'
| 40 => 'h'
| 41 => 'i'
| 42 => 'j'
| 43 => 'k'
| 44 => 'm'
| 45 => 'n'
| 46 => 'o'
| 47 => 'p'
| 48 => 'q'
| 49 => 'r'
| 50 => 's'
| 51 => 't'
| 52 => 'u'
| 53 => 'v'
| 54 => 'w'
| 55 => 'x'
| 56 => 'y'
| 57 => 'z'
| _ => '1'

def readBase58BTC : Char → Option Nat
| '1' => some 0
| '2' => some 1
| '3' => some 2
| '4' => some 3
| '5' => some 4
| '6' => some 5
| '7' => some 6
| '8' => some 7
| '9' => some 8
| 'A' => some 9
| 'B' => some 10
| 'C' => some 11
| 'D' => some 12
| 'E' => some 13
| 'F' => some 14
| 'G' => some 15
| 'H' => some 16
| 'J' => some 17
| 'K' => some 18
| 'L' => some 19
| 'M' => some 20
| 'N' => some 21
| 'P' => some 22
| 'Q' => some 23
| 'R' => some 24
| 'S' => some 25
| 'T' => some 26
| 'U' => some 27
| 'V' => some 28
| 'W' => some 29
| 'X' => some 30
| 'Y' => some 31
| 'Z' => some 32
| 'a' => some 33
| 'b' => some 34
| 'c' => some 35
| 'd' => some 36
| 'e' => some 37
| 'f' => some 38
| 'g' => some 39
| 'h' => some 40
| 'i' => some 41
| 'j' => some 42
| 'k' => some 43
| 'm' => some 44
| 'n' => some 45
| 'o' => some 46
| 'p' => some 47
| 'q' => some 48
| 'r' => some 49
| 's' => some 50
| 't' => some 51
| 'u' => some 52
| 'v' => some 53
| 'w' => some 54
| 'x' => some 55
| 'y' => some 56
| 'z' => some 57
| _ => none
def digitBase64 : Nat → Char
| 0  => 'A'
| 1  => 'B'
| 2  => 'C'
| 3  => 'D'
| 4  => 'E'
| 5  => 'F'
| 6  => 'G'
| 7  => 'H'
| 8  => 'I'
| 9  => 'J'
| 10 => 'K'
| 11 => 'L'
| 12 => 'M'
| 13 => 'N'
| 14 => 'O'
| 15 => 'P'
| 16 => 'Q'
| 17 => 'R'
| 18 => 'S'
| 19 => 'T'
| 20 => 'U'
| 21 => 'V'
| 22 => 'W'
| 23 => 'X'
| 24 => 'Y'
| 25 => 'Z'
| 26 => 'a'
| 27 => 'b'
| 28 => 'c'
| 29 => 'd'
| 30 => 'e'
| 31 => 'f'
| 32 => 'g'
| 33 => 'h'
| 34 => 'i'
| 35 => 'j'
| 36 => 'k'
| 37 => 'l'
| 38 => 'm'
| 39 => 'n'
| 40 => 'o'
| 41 => 'p'
| 42 => 'q'
| 43 => 'r'
| 44 => 's'
| 45 => 't'
| 46 => 'u'
| 47 => 'v'
| 48 => 'w'
| 49 => 'x'
| 50 => 'y'
| 51 => 'z'
| 52 => '0'
| 53 => '1'
| 54 => '2'
| 55 => '3'
| 56 => '4'
| 57 => '5'
| 58 => '6'
| 59 => '7'
| 60 => '8'
| 61 => '9'
| 62 => '+'
| 63 => '/'
| _  => 'A'

def readBase64 : Char → Option Nat
| 'A' => some 0
| 'B' => some 1
| 'C' => some 2
| 'D' => some 3
| 'E' => some 4
| 'F' => some 5
| 'G' => some 6
| 'H' => some 7
| 'I' => some 8
| 'J' => some 9
| 'K' => some 10
| 'L' => some 11
| 'M' => some 12
| 'N' => some 13
| 'O' => some 14
| 'P' => some 15
| 'Q' => some 16
| 'R' => some 17
| 'S' => some 18
| 'T' => some 19
| 'U' => some 20
| 'V' => some 21
| 'W' => some 22
| 'X' => some 23
| 'Y' => some 24
| 'Z' => some 25
| 'a' => some 26
| 'b' => some 27
| 'c' => some 28
| 'd' => some 29
| 'e' => some 30
| 'f' => some 31
| 'g' => some 32
| 'h' => some 33
| 'i' => some 34
| 'j' => some 35
| 'k' => some 36
| 'l' => some 37
| 'm' => some 38
| 'n' => some 39
| 'o' => some 40
| 'p' => some 41
| 'q' => some 42
| 'r' => some 43
| 's' => some 44
| 't' => some 45
| 'u' => some 46
| 'v' => some 47
| 'w' => some 48
| 'x' => some 49
| 'y' => some 50
| 'z' => some 51
| '0' => some 52
| '1' => some 53
| '2' => some 54
| '3' => some 55
| '4' => some 56
| '5' => some 57
| '6' => some 58
| '7' => some 59
| '8' => some 60
| '9' => some 61
| '+' => some 62
| '/' => some 63
| _ => none

def digitBase64URL : Nat → Char
| 0  => 'A'
| 1  => 'B'
| 2  => 'C'
| 3  => 'D'
| 4  => 'E'
| 5  => 'F'
| 6  => 'G'
| 7  => 'H'
| 8  => 'I'
| 9  => 'J'
| 10 => 'K'
| 11 => 'L'
| 12 => 'M'
| 13 => 'N'
| 14 => 'O'
| 15 => 'P'
| 16 => 'Q'
| 17 => 'R'
| 18 => 'S'
| 19 => 'T'
| 20 => 'U'
| 21 => 'V'
| 22 => 'W'
| 23 => 'X'
| 24 => 'Y'
| 25 => 'Z'
| 26 => 'a'
| 27 => 'b'
| 28 => 'c'
| 29 => 'd'
| 30 => 'e'
| 31 => 'f'
| 32 => 'g'
| 33 => 'h'
| 34 => 'i'
| 35 => 'j'
| 36 => 'k'
| 37 => 'l'
| 38 => 'm'
| 39 => 'n'
| 40 => 'o'
| 41 => 'p'
| 42 => 'q'
| 43 => 'r'
| 44 => 's'
| 45 => 't'
| 46 => 'u'
| 47 => 'v'
| 48 => 'w'
| 49 => 'x'
| 50 => 'y'
| 51 => 'z'
| 52 => '0'
| 53 => '1'
| 54 => '2'
| 55 => '3'
| 56 => '4'
| 57 => '5'
| 58 => '6'
| 59 => '7'
| 60 => '8'
| 61 => '9'
| 62 => '-'
| 63 => '_'
| _  => 'A'

def readBase64URL : Char → Option Nat
| 'A' => some 0
| 'B' => some 1
| 'C' => some 2
| 'D' => some 3
| 'E' => some 4
| 'F' => some 5
| 'G' => some 6
| 'H' => some 7
| 'I' => some 8
| 'J' => some 9
| 'K' => some 10
| 'L' => some 11
| 'M' => some 12
| 'N' => some 13
| 'O' => some 14
| 'P' => some 15
| 'Q' => some 16
| 'R' => some 17
| 'S' => some 18
| 'T' => some 19
| 'U' => some 20
| 'V' => some 21
| 'W' => some 22
| 'X' => some 23
| 'Y' => some 24
| 'Z' => some 25
| 'a' => some 26
| 'b' => some 27
| 'c' => some 28
| 'd' => some 29
| 'e' => some 30
| 'f' => some 31
| 'g' => some 32
| 'h' => some 33
| 'i' => some 34
| 'j' => some 35
| 'k' => some 36
| 'l' => some 37
| 'm' => some 38
| 'n' => some 39
| 'o' => some 40
| 'p' => some 41
| 'q' => some 42
| 'r' => some 43
| 's' => some 44
| 't' => some 45
| 'u' => some 46
| 'v' => some 47
| 'w' => some 48
| 'x' => some 49
| 'y' => some 50
| 'z' => some 51
| '0' => some 52
| '1' => some 53
| '2' => some 54
| '3' => some 55
| '4' => some 56
| '5' => some 57
| '6' => some 58
| '7' => some 59
| '8' => some 60
| '9' => some 61
| '-' => some 62
| '_' => some 63
| _ => none
